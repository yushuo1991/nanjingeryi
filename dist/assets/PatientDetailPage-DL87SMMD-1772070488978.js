var Ce=Object.defineProperty,ke=Object.defineProperties;var Le=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var ze=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable;var ce=(d,n,c)=>n in d?Ce(d,n,{enumerable:!0,configurable:!0,writable:!0,value:c}):d[n]=c,o=(d,n)=>{for(var c in n||(n={}))ze.call(n,c)&&ce(d,c,n[c]);if(oe)for(var c of oe(n))Re.call(n,c)&&ce(d,c,n[c]);return d},b=(d,n)=>ke(d,Le(n));var ie=(d,n,c)=>new Promise((C,m)=>{var l=g=>{try{v(c.next(g))}catch(y){m(y)}},x=g=>{try{v(c.throw(g))}catch(y){m(y)}},v=g=>g.done?C(g.value):Promise.resolve(g.value).then(l,x);v((c=c.apply(d,n)).next())});import{c as I,R as Te,r as u,a as qe,j as e,b as Se}from"./index-CANltA1C-1772070488978.js";import{g as Ie,p as Oe,X as R,d as de,a as Ae,e as Fe,S as me,F as xe,C as T,b as $e,c as s}from"./RehabCareLink-DNlDu4M5-1772070488978.js";import{C as Be}from"./chevron-left-BDJfO_qT-1772070488978.js";import{C as pe}from"./check-BJ2KGarp-1772070488978.js";import{T as be}from"./trash-2-CGkyqpbx-1772070488978.js";import{P as Ge}from"./printer-Dckhb69q-1772070488978.js";import{P as q}from"./pen-line-BG_mQ2g9-1772070488978.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=I("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=I("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=I("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),O=Te.memo(({selectedPatient:d,userRole:n,detailTab:c,setDetailTab:C,isEditingDetail:m,editedPatient:l,setEditedPatient:x,goBack:v,savePatientEdit:g,toggleEditMode:y,setShowDeleteConfirm:A,toggleTreatmentItem:F,generateTodayLog:$,setShowQuickEntry:B,updatePatient:k})=>{var J,M,Q,X,K,U,V,W,Y,Z,D,P,E;const a=d;if(!a)return null;const[j,G]=u.useState(""),[_,L]=u.useState(!1),[z,H]=u.useState(!1),[h,w]=u.useState(null),ue=u.useCallback(()=>{Ie(a)},[a]),he=u.useCallback(()=>{Oe(a)},[a]),ge=u.useCallback(()=>{A(!0)},[A]),je=u.useCallback(()=>{B(!0)},[B]),fe=u.useCallback(()=>{$(a)},[$,a]),Ne=u.useCallback(t=>{F(a.id,t)},[F,a.id]),ve=u.useCallback(()=>{var r;const t={date:"2026-01-11",items:a.treatmentPlan.items.filter(N=>N.completed).map(N=>N.name),highlight:((r=a.treatmentPlan.highlights)==null?void 0:r[0])||"å¸¸è§„è®­ç»ƒ",notes:"æ²»ç–—é¡ºåˆ©å®Œæˆ",therapist:"å´å¤§å‹‡"};k(a.id,{todayTreated:!0,treatmentLogs:[t,...a.treatmentLogs||[]]})},[a,k]),ye=u.useCallback(()=>ie(null,null,function*(){if(j.trim()){H(!0),w(null);try{const t={patient:{name:a.name,gender:a.gender,age:a.age,bedNo:a.bedNo,department:a.department,diagnosis:a.diagnosis,admissionDate:a.admissionDate},risks:a.risks||[],contraindications:a.contraindications||[],monitoring:a.monitoring||[],keyFindings:a.keyFindings||[]},r=yield qe(`/api/patients/${a.id}/regenerate-plan`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({supplementNotes:j.trim(),profile:t})});r!=null&&r.success&&r.plan&&w(r.plan)}catch(t){console.error("AI regenerate plan failed:",t),alert("AIé‡æ–°ç”Ÿæˆæ–¹æ¡ˆå¤±è´¥: "+(t.message||"æœªçŸ¥é”™è¯¯"))}finally{H(!1)}}}),[j,a]),we=u.useCallback(()=>{h&&(k(a.id,{treatmentPlan:o(o({},a.treatmentPlan),h),supplementNotes:j.trim()}),w(null),L(!1),G(""))},[h,a,k,j]);return e.jsx("div",{className:"min-h-screen flex justify-center pt-6 pb-6 px-4",children:e.jsxs("div",{className:"main-glass-container w-full max-w-md relative overflow-hidden flex flex-col p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center gap-3",children:[e.jsx("button",{onClick:v,className:"p-2 -ml-2 rounded-full hover:bg-slate-100 transition-all",children:e.jsx(Be,{size:24,className:"text-slate-600"})}),e.jsx("h1",{className:"text-lg font-extrabold text-slate-800 flex-1",children:"æ‚£å„¿è¯¦æƒ…"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:ue,className:"p-2 hover:bg-blue-100 rounded-xl transition-all",title:"ç”Ÿæˆæ²»ç–—å¡ç‰‡",children:e.jsx(He,{size:20,className:"text-blue-500"})}),e.jsx("button",{onClick:he,className:"p-2 hover:bg-slate-100 rounded-xl transition-all",title:"æ‰“å°æ‚£è€…æ¡£æ¡ˆ",children:e.jsx(Ge,{size:20,className:"text-slate-500"})}),n==="therapist"&&e.jsxs(e.Fragment,{children:[m&&e.jsx("button",{onClick:g,className:"p-2 bg-emerald-100 text-emerald-600 rounded-xl transition-all hover:bg-emerald-200",title:"ä¿å­˜",children:e.jsx(pe,{size:20})}),e.jsx("button",{onClick:y,className:`p-2 rounded-xl transition-all ${m?"bg-slate-100 text-slate-600 hover:bg-slate-200":"hover:bg-slate-100 text-slate-500"}`,title:m?"å–æ¶ˆç¼–è¾‘":"ç¼–è¾‘è¯¦æƒ…",children:m?e.jsx(R,{size:20}):e.jsx(q,{size:20})})]}),n==="therapist"&&e.jsx("button",{onClick:ge,className:"p-2 hover:bg-rose-100 rounded-xl transition-all",title:"åˆ é™¤æ‚£è€…",children:e.jsx(be,{size:20,className:"text-rose-500"})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto hide-scrollbar pb-20",children:[e.jsx("div",{className:"bg-white/60 backdrop-blur-xl rounded-2xl p-5 border border-white/50 shadow-sm mb-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-100 to-purple-100 rounded-2xl flex items-center justify-center text-3xl border-2 border-white shadow-sm flex-shrink-0",children:a.avatar}),e.jsx("div",{className:"flex-1 min-w-0",children:m&&l?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("input",{type:"text",value:l.name,onChange:t=>x(b(o({},l),{name:t.target.value})),className:"text-xl font-bold text-slate-800 border-b-2 border-blue-400 focus:border-blue-500 outline-none bg-transparent w-24",placeholder:"å§“å"}),e.jsx("input",{type:"text",value:l.age,onChange:t=>x(b(o({},l),{age:t.target.value})),className:"text-sm text-slate-600 border-b-2 border-blue-400 focus:border-blue-500 outline-none bg-transparent w-16",placeholder:"å¹´é¾„"}),e.jsxs("select",{value:l.gender,onChange:t=>x(b(o({},l),{gender:t.target.value})),className:"text-sm text-slate-600 border-b-2 border-blue-400 focus:border-blue-500 outline-none bg-transparent",children:[e.jsx("option",{value:"ç”·",children:"ç”·"}),e.jsx("option",{value:"å¥³",children:"å¥³"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"åºŠå·ï¼š"}),e.jsx("input",{type:"text",value:l.bedNo,onChange:t=>x(b(o({},l),{bedNo:t.target.value})),className:"text-sm text-slate-700 border-b-2 border-blue-400 focus:border-blue-500 outline-none bg-transparent w-16",placeholder:"åºŠå·"}),e.jsx("span",{className:"text-slate-300",children:"Â·"}),e.jsx("input",{type:"text",value:l.department,onChange:t=>x(b(o({},l),{department:t.target.value})),className:"text-sm text-slate-700 border-b-2 border-blue-400 focus:border-blue-500 outline-none bg-transparent w-24",placeholder:"ç§‘å®¤"})]}),e.jsx("input",{type:"text",value:l.diagnosis,onChange:t=>x(b(o({},l),{diagnosis:t.target.value})),className:"text-blue-600 font-medium border-b-2 border-blue-400 focus:border-blue-500 outline-none bg-transparent w-full",placeholder:"è¯Šæ–­"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:a.name}),e.jsxs("span",{className:"text-sm text-slate-400",children:[a.age," Â· ",a.gender]})]}),e.jsxs("p",{className:"text-sm text-slate-400 mb-1",children:["åºŠå·ï¼š",a.bedNo," Â· ",a.department]}),e.jsx("p",{className:"text-blue-600 font-semibold",children:a.diagnosis})]})})]})}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx(S,{active:c==="today",onClick:()=>C("today"),children:"ðŸ“‹ ä»Šæ—¥æ²»ç–—"}),e.jsx(S,{active:c==="logs",onClick:()=>C("logs"),children:"ðŸ“… æ²»ç–—æ—¥å¿—"})]}),c==="today"&&e.jsxs("div",{className:"bg-white/60 backdrop-blur-xl rounded-2xl p-4 border border-white/50 shadow-sm",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded-xl p-4 mb-4",children:[e.jsxs("h5",{className:"text-sm font-bold text-slate-700 flex items-center gap-2 mb-2",children:[e.jsx(Je,{size:16,className:"text-blue-500"}),"æ²»ç–—ç›®æ ‡"]}),m&&l?e.jsx("textarea",{value:((J=l.treatmentPlan)==null?void 0:J.focus)||"",onChange:t=>x(b(o({},l),{treatmentPlan:b(o({},l.treatmentPlan),{focus:t.target.value})})),className:"text-sm text-slate-700 leading-relaxed w-full bg-white border border-blue-200 rounded-lg p-2 focus:border-blue-400 outline-none resize-none",rows:2,placeholder:"æ²»ç–—ç›®æ ‡"}):e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:(M=a.treatmentPlan)==null?void 0:M.focus})]}),((X=(Q=a.treatmentPlan)==null?void 0:Q.highlights)==null?void 0:X.length)>0&&e.jsxs("div",{className:"bg-amber-50 border border-amber-100 rounded-xl p-4 mb-4",children:[e.jsxs("h5",{className:"text-sm font-bold text-slate-700 flex items-center gap-2 mb-2",children:[e.jsx(de,{size:16,className:"text-amber-500"}),"ä»Šæ—¥ä¸ªæ€§åŒ–é‡ç‚¹"]}),e.jsx("ul",{className:"text-sm text-slate-600 space-y-1.5",children:a.treatmentPlan.highlights.map((t,r)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-amber-500 mt-0.5",children:"â€¢"}),e.jsx("span",{className:"flex-1",children:t})]},r))})]}),((U=(K=a.treatmentPlan)==null?void 0:K.precautions)==null?void 0:U.length)>0&&e.jsxs("div",{className:"bg-rose-50 border border-rose-100 rounded-xl p-4 mb-4",children:[e.jsxs("h5",{className:"text-sm font-bold text-slate-700 flex items-center gap-2 mb-2",children:[e.jsx(Ae,{size:16,className:"text-rose-500"}),"æ³¨æ„äº‹é¡¹"]}),e.jsx("ul",{className:"text-sm text-slate-600 space-y-1.5",children:a.treatmentPlan.precautions.map((t,r)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-rose-500 mt-0.5",children:"âš "}),e.jsx("span",{className:"flex-1",children:t})]},r))})]}),n==="therapist"&&a.treatmentPlan&&e.jsxs("div",{className:"mb-4",children:[a.supplementNotes&&!_&&e.jsxs("div",{className:"bg-indigo-50 border border-indigo-100 rounded-xl p-3 mb-2",children:[e.jsx("p",{className:"text-xs text-indigo-400 mb-1",children:"è¡¥å……è¯´æ˜Ž"}),e.jsx("p",{className:"text-sm text-slate-600",children:a.supplementNotes})]}),_?e.jsxs("div",{className:"bg-indigo-50/50 border border-indigo-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h5",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[e.jsx(q,{size:14,className:"text-indigo-500"}),"è¡¥å……è¯´æ˜Ž"]}),e.jsx("button",{onClick:()=>{L(!1),w(null)},className:"p-1 rounded-full hover:bg-slate-200 transition-all",children:e.jsx(R,{size:16,className:"text-slate-400"})})]}),e.jsx("p",{className:"text-xs text-slate-400 mb-2",children:"è¾“å…¥æ”¶æ²»åŽå‘çŽ°çš„æ–°æƒ…å†µã€ç—…æƒ…è¡¥å……æˆ–çº æ­£ä¿¡æ¯ï¼ŒAIå°†æ®æ­¤é‡æ–°ç”Ÿæˆæ²»ç–—æ–¹æ¡ˆ"}),e.jsx("textarea",{value:j,onChange:t=>G(t.target.value),className:"w-full bg-white border border-indigo-200 rounded-lg p-3 text-sm text-slate-700 focus:border-indigo-400 outline-none resize-none",rows:3,placeholder:"ä¾‹å¦‚ï¼šæ‚£å„¿å·¦ä¾§è‚¢ä½“è‚Œå¼ åŠ›åé«˜ï¼Œéœ€åŠ å¼ºå·¦ä¾§è¢«åŠ¨æ´»åŠ¨...",disabled:z}),e.jsx("button",{onClick:ye,disabled:!j.trim()||z,className:"mt-2 w-full flex items-center justify-center gap-2 py-2.5 rounded-xl text-sm font-semibold text-white bg-gradient-to-r from-indigo-500 to-purple-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:z?e.jsxs(e.Fragment,{children:[e.jsx(Se,{size:16,className:"animate-spin"}),"AIæ­£åœ¨é‡æ–°ç”Ÿæˆæ–¹æ¡ˆ..."]}):e.jsxs(e.Fragment,{children:[e.jsx(me,{size:16}),"AIé‡æ–°ç”Ÿæˆæ–¹æ¡ˆ"]})}),h&&e.jsxs("div",{className:"mt-3 bg-white border border-emerald-200 rounded-xl p-3",children:[e.jsxs("h6",{className:"text-sm font-bold text-emerald-700 mb-2 flex items-center gap-1",children:[e.jsx(me,{size:14}),"AIç”Ÿæˆçš„æ–°æ–¹æ¡ˆ"]}),h.focus&&e.jsxs("p",{className:"text-xs text-slate-600 mb-2",children:[e.jsx("span",{className:"font-semibold",children:"æ²»ç–—ç›®æ ‡ï¼š"}),h.focus]}),((V=h.items)==null?void 0:V.length)>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-xs font-semibold text-slate-500 mb-1",children:"è®­ç»ƒé¡¹ç›®ï¼š"}),h.items.map((t,r)=>e.jsxs("p",{className:"text-xs text-slate-600 ml-2",children:[r+1,". ",t.name," (",t.duration,")"]},r))]}),((W=h.precautions)==null?void 0:W.length)>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-xs font-semibold text-slate-500 mb-1",children:"æ³¨æ„äº‹é¡¹ï¼š"}),h.precautions.map((t,r)=>e.jsxs("p",{className:"text-xs text-slate-600 ml-2",children:["âš  ",t]},r))]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsxs("button",{onClick:we,className:"flex-1 flex items-center justify-center gap-1 py-2 rounded-lg text-sm font-semibold text-white bg-emerald-500 hover:bg-emerald-600 transition-all",children:[e.jsx(pe,{size:16}),"é‡‡ç”¨æ­¤æ–¹æ¡ˆ"]}),e.jsxs("button",{onClick:()=>w(null),className:"flex-1 flex items-center justify-center gap-1 py-2 rounded-lg text-sm font-semibold text-slate-600 bg-slate-100 hover:bg-slate-200 transition-all",children:[e.jsx(R,{size:16}),"æ”¾å¼ƒ"]})]})]})]}):e.jsxs("button",{onClick:()=>L(!0),className:"w-full flex items-center justify-center gap-2 py-2.5 rounded-xl border border-dashed border-indigo-300 text-indigo-500 text-sm hover:bg-indigo-50 transition-all",children:[e.jsx(q,{size:14}),"è¡¥å……è¯´æ˜Ž / AIé‡æ–°ç”Ÿæˆæ–¹æ¡ˆ",e.jsx(Fe,{size:14})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h5",{className:"text-xs font-bold text-slate-700 uppercase tracking-wide",children:"æ²»ç–—é¡¹ç›®"}),n==="therapist"&&e.jsxs("button",{onClick:fe,className:"btn-particle py-1.5 px-3 rounded-xl text-xs",children:[e.jsxs("div",{className:"points_wrapper",children:[e.jsx("div",{className:"point"}),e.jsx("div",{className:"point"}),e.jsx("div",{className:"point"})]}),e.jsxs("span",{className:"inner",children:[e.jsx(xe,{size:14}),"ç”Ÿæˆä»Šæ—¥æ—¥å¿—"]})]})]}),((Z=(Y=a.treatmentPlan)==null?void 0:Y.items)==null?void 0:Z.length)>0?e.jsx("div",{className:"space-y-2",children:a.treatmentPlan.items.map(t=>e.jsxs("div",{onClick:()=>Ne(t.id),className:`flex items-center gap-3 p-3 rounded-xl border transition cursor-pointer ${t.completed?"bg-emerald-50 border-emerald-200":"bg-white/50 border-slate-100 hover:border-blue-200"}`,children:[e.jsx("span",{className:"text-2xl",children:t.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-semibold ${t.completed?"text-emerald-600":"text-slate-700"}`,children:t.name}),e.jsx("span",{className:"text-xs text-slate-400",children:t.duration})]}),e.jsx("p",{className:"text-xs text-slate-400",children:t.note})]}),t.completed?e.jsx(T,{size:24,className:"text-emerald-500"}):e.jsx(_e,{size:24,className:"text-slate-300"})]},t.id))}):e.jsxs("div",{className:"text-center py-8 text-slate-400",children:[e.jsx($e,{size:40,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"æš‚æ— æ²»ç–—å®‰æŽ’"}),n==="therapist"&&e.jsxs("button",{onClick:je,className:"mt-3 btn-particle btn-particle-cyan px-4 py-2 rounded-full text-sm",children:[e.jsxs("div",{className:"points_wrapper",children:[e.jsx("div",{className:"point"}),e.jsx("div",{className:"point"}),e.jsx("div",{className:"point"})]}),e.jsx("span",{className:"inner",children:"å¿«é€Ÿå½•å…¥"})]})]}),n==="therapist"&&((P=(D=a.treatmentPlan)==null?void 0:D.items)==null?void 0:P.length)>0&&!a.todayTreated&&e.jsxs("button",{onClick:ve,className:"w-full mt-4 btn-particle btn-particle-emerald py-3 rounded-xl",children:[e.jsxs("div",{className:"points_wrapper",children:[e.jsx("div",{className:"point"}),e.jsx("div",{className:"point"}),e.jsx("div",{className:"point"}),e.jsx("div",{className:"point"}),e.jsx("div",{className:"point"})]}),e.jsxs("span",{className:"inner",children:[e.jsx(T,{size:18}),"å®Œæˆä»Šæ—¥æ²»ç–—"]})]}),a.todayTreated&&e.jsxs("div",{className:"mt-4 text-center text-emerald-600 flex items-center justify-center gap-2 font-semibold",children:[e.jsx(T,{size:20,className:"text-emerald-500"}),"ä»Šæ—¥æ²»ç–—å·²å®Œæˆ"]})]}),c==="logs"&&e.jsx("div",{className:"bg-white/60 backdrop-blur-xl rounded-2xl p-4 border border-white/50 shadow-sm",children:((E=a.treatmentLogs)==null?void 0:E.length)>0?e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-4 top-0 bottom-0 w-0.5 bg-blue-200"}),e.jsx("div",{className:"space-y-6",children:a.treatmentLogs.map((t,r)=>{var N,ee,se,te,ae,le,re,ne;return e.jsxs("div",{className:"relative pl-10",children:[e.jsx("div",{className:"absolute left-2.5 top-1 w-3 h-3 bg-blue-500 rounded-full border-2 border-white shadow-sm"}),e.jsxs("div",{className:"bg-white/70 rounded-xl p-3 border border-slate-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[m&&l?e.jsx("input",{type:"date",value:((ee=(N=l.treatmentLogs)==null?void 0:N[r])==null?void 0:ee.date)||t.date,onChange:p=>{const i=[...l.treatmentLogs||a.treatmentLogs.map(f=>o({},f))];i[r]||(i[r]=o({},t)),i[r].date=p.target.value,x(b(o({},l),{treatmentLogs:i}))},className:"text-sm font-bold text-slate-700 border-b-2 border-blue-400 focus:border-blue-500 outline-none bg-transparent"}):e.jsx("span",{className:"text-sm font-bold text-slate-700",children:t.date}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-slate-400",children:t.therapist}),n==="therapist"&&m&&e.jsx("button",{onClick:()=>{if(window.confirm("ç¡®å®šè¦åˆ é™¤è¿™æ¡æ²»ç–—è®°å½•å—ï¼Ÿ")){const p=[...(l==null?void 0:l.treatmentLogs)||a.treatmentLogs];p.splice(r,1),x(b(o({},l),{treatmentLogs:p}))}},className:"p-1 rounded-full bg-rose-100 text-rose-500 hover:bg-rose-200 transition-colors",children:e.jsx(be,{size:14})})]})]}),e.jsx("div",{className:"bg-amber-50 border border-amber-100 rounded-lg p-2 mb-2",children:m&&l?e.jsx("textarea",{value:((te=(se=l.treatmentLogs)==null?void 0:se[r])==null?void 0:te.highlight)||t.highlight,onChange:p=>{const i=[...l.treatmentLogs||a.treatmentLogs.map(f=>o({},f))];i[r]||(i[r]=o({},t)),i[r].highlight=p.target.value,x(b(o({},l),{treatmentLogs:i}))},className:"text-sm text-slate-700 w-full bg-transparent border-none outline-none resize-none",rows:2}):e.jsxs("p",{className:"text-sm text-slate-700 flex items-center gap-1",children:[e.jsx(de,{size:14,className:"text-amber-500"}),t.highlight]})}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:t.items.map((p,i)=>e.jsx("span",{className:"text-xs bg-blue-100 text-blue-600 px-2 py-0.5 rounded-lg font-medium",children:typeof p=="string"?p:p.name},i))}),(t.detailRecord||m)&&e.jsx("div",{className:"bg-slate-50 rounded-lg p-2 mb-2",children:m&&l?e.jsx("textarea",{value:((le=(ae=l.treatmentLogs)==null?void 0:ae[r])==null?void 0:le.detailRecord)||t.detailRecord||"",onChange:p=>{const i=[...l.treatmentLogs||a.treatmentLogs.map(f=>o({},f))];i[r]||(i[r]=o({},t)),i[r].detailRecord=p.target.value,x(b(o({},l),{treatmentLogs:i}))},className:"text-xs text-slate-600 leading-relaxed w-full bg-transparent border-none outline-none resize-none",rows:3,placeholder:"è¯¦ç»†è®°å½•"}):e.jsx("p",{className:"text-xs text-slate-500 leading-relaxed whitespace-pre-wrap",children:t.detailRecord})}),m&&l?e.jsx("textarea",{value:((ne=(re=l.treatmentLogs)==null?void 0:re[r])==null?void 0:ne.notes)||t.notes||"",onChange:p=>{const i=[...l.treatmentLogs||a.treatmentLogs.map(f=>o({},f))];i[r]||(i[r]=o({},t)),i[r].notes=p.target.value,x(b(o({},l),{treatmentLogs:i}))},className:"text-xs text-slate-600 w-full bg-slate-50 border border-slate-200 rounded-lg p-2 outline-none resize-none",rows:2,placeholder:"å¤‡æ³¨"}):e.jsx("p",{className:"text-xs text-slate-400",children:t.notes})]})]},r)})})]}):e.jsxs("div",{className:"text-center py-8 text-slate-400",children:[e.jsx(xe,{size:40,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"æš‚æ— æ²»ç–—è®°å½•"})]})})]})]})})}),S=({children:d,active:n,onClick:c})=>e.jsx("button",{onClick:c,className:`flex-1 py-2.5 rounded-xl text-sm font-semibold transition-all duration-200 ${n?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-md":"bg-white/50 text-slate-500 border border-slate-200 hover:border-blue-300"}`,children:d});O.displayName="PatientDetailPage";S.displayName="TabButton";O.propTypes={selectedPatient:s.shape({id:s.oneOfType([s.string,s.number]),name:s.string,avatar:s.string,bedNo:s.string,diagnosis:s.string,status:s.string,admissionDate:s.string,department:s.string,age:s.string,gender:s.string,guardian:s.string,contact:s.string,address:s.string,medicalHistory:s.string,allergies:s.string,safetyAlerts:s.arrayOf(s.string),gasGoals:s.arrayOf(s.shape({id:s.oneOfType([s.string,s.number]),goal:s.string,baseline:s.string,target:s.string,current:s.string,progress:s.number})),treatmentPlan:s.arrayOf(s.shape({id:s.oneOfType([s.string,s.number]),name:s.string,frequency:s.string,duration:s.string,therapist:s.string,notes:s.string,completed:s.bool})),executionLog:s.arrayOf(s.shape({date:s.string,items:s.arrayOf(s.string),notes:s.string}))}),userRole:s.oneOf(["therapist","doctor"]).isRequired,detailTab:s.string.isRequired,setDetailTab:s.func.isRequired,isEditingDetail:s.bool.isRequired,editedPatient:s.object,setEditedPatient:s.func.isRequired,goBack:s.func.isRequired,savePatientEdit:s.func.isRequired,toggleEditMode:s.func.isRequired,setShowDeleteConfirm:s.func.isRequired,toggleTreatmentItem:s.func.isRequired,generateTodayLog:s.func.isRequired,setShowQuickEntry:s.func.isRequired,updatePatient:s.func.isRequired};O.defaultProps={selectedPatient:null,editedPatient:null};export{O as default};
