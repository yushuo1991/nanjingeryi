var H=Object.defineProperty,O=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var k=(n,t,a)=>t in n?H(n,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[t]=a,i=(n,t)=>{for(var a in t||(t={}))K.call(t,a)&&k(n,a,t[a]);if(C)for(var a of C(t))V.call(t,a)&&k(n,a,t[a]);return n},x=(n,t)=>O(n,J(t));import{c as I,r as X,j as e,b as q}from"./index-tLO3RpaO-1770444204813.js";import{M as $,C as D,F as Q,U as S,a as W,T as Y,X as Z,b as _,P as z,S as P,c as l}from"./RehabCareLink-D-hlOxJv-1770444204813.js";import{C as F}from"./check-BddYGKRJ-1770444204813.js";import{T as ee}from"./trash-2-CE-cjzd6-1770444204813.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=I("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=I("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),R=({isOpen:n,onClose:t,aiStep:a,setAiStep:m,aiResult:r,setAiResult:c,uploadedImage:u,setUploadedImage:b,ocrText:te,setOcrText:h,ocrProgress:ae,setOcrProgress:v,handleImageUpload:T,updateFormField:d,addSafetyAlert:p,removeSafetyAlert:A,addTreatmentItem:M,updateTreatmentItem:y,removeTreatmentItem:L,handleGeneratePlan:U,confirmAdmission:E,isOcrProcessing:w,isSavingPatient:g,departments:G})=>{const[j,f]=X.useState(""),B=()=>{t(),m(0),c(null),b(null),h(""),v(0)};return e.jsxs($,{isOpen:n,onClose:B,title:"AI智能建档",icon:e.jsx(P,{className:"text-blue-500",size:20}),children:[a===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-100 to-purple-100 rounded-3xl flex items-center justify-center mx-auto mb-4 border-2 border-white shadow-md",children:e.jsx(le,{size:36,className:"text-blue-500"})}),e.jsx("h4",{className:"text-lg font-bold text-slate-800 mb-2",children:"上传病历资料"}),e.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"上传病历图片，AI将自动识别并提取患者信息"}),e.jsx("input",{type:"file",id:"medical-record-upload",accept:"image/jpeg,image/jpg,image/png,image/webp",multiple:!0,onChange:T,className:"hidden"}),e.jsxs("label",{htmlFor:"medical-record-upload",className:"block border-2 border-dashed border-slate-200 rounded-3xl p-8 mb-4 hover:border-blue-400 hover:bg-blue-50 transition-all cursor-pointer",children:[e.jsx(se,{size:32,className:"text-slate-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-slate-700 font-medium",children:"点击选择图片或拍照（支持多图）"}),e.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"支持 JPG、PNG 等图片格式"})]}),e.jsx("p",{className:"text-xs text-slate-400",children:"图片将作为病历附件保存，方便日后查阅"})]}),a===1&&e.jsxs("div",{className:"text-center py-12",children:[e.jsxs("div",{className:"relative w-24 h-24 mx-auto mb-6",children:[u&&e.jsx("img",{src:u,alt:"病历",className:"w-full h-full object-cover rounded-2xl opacity-50"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80 rounded-2xl",children:e.jsx(q,{size:32,className:"text-blue-500 animate-spin"})})]}),e.jsx("h4",{className:"text-lg font-bold text-slate-800 mb-2",children:"AI识别中..."}),e.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"正在识别病例图片，请稍候"}),e.jsxs("div",{className:"max-w-xs mx-auto",children:[e.jsx("div",{className:"w-full bg-slate-100 rounded-full h-2.5 mb-2 overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-400 to-purple-400 h-2.5 rounded-full animate-pulse",style:{width:"100%",opacity:.8}})}),e.jsx("p",{className:"text-xs text-slate-400",children:"识别中，请耐心等待..."})]}),e.jsx("p",{className:"text-xs text-slate-400 mt-6",children:"AI智能识别 · 图片理解"})]}),a===2&&r&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-emerald-50 border border-emerald-200 rounded-2xl p-3 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(D,{size:16,className:"text-emerald-500"}),e.jsx("span",{className:"text-sm font-semibold text-emerald-600",children:"AI识别完成"})]}),e.jsx("p",{className:"text-xs text-slate-600",children:"已自动填充识别到的信息，请核对并补充，然后生成训练方案。"})]}),e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-3",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Q,{size:16,className:"text-slate-500"}),e.jsx("span",{className:"text-sm font-semibold text-slate-700",children:"病历附件"}),e.jsx("button",{onClick:()=>{m(0),b(null),c(null),h("")},className:"ml-auto text-xs text-rose-500 hover:text-rose-600 font-medium",children:"重新上传"})]}),e.jsx("img",{src:u,alt:"病历",className:"w-full max-h-40 object-contain rounded-xl border border-slate-200"})]}),e.jsxs("div",{className:"bg-white/70 backdrop-blur-xl rounded-2xl p-4 border border-slate-100 shadow-sm",children:[e.jsxs("h5",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[e.jsx(S,{size:16,className:"text-blue-500"}),"基本信息 ",e.jsx("span",{className:"text-rose-500",children:"*"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500 mb-1 block",children:"姓名 *"}),e.jsx("input",{type:"text",value:r.name,onChange:s=>d("name",s.target.value),placeholder:"请输入患儿姓名",className:"w-full border border-slate-200 rounded-xl px-3 py-2 text-sm text-slate-700 placeholder-slate-400 focus:border-blue-400 focus:ring-2 focus:ring-blue-100 outline-none bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500 mb-1 block",children:"年龄 *"}),e.jsx("input",{type:"text",value:r.age,onChange:s=>d("age",s.target.value),placeholder:"如：5岁3个月",className:"w-full border border-slate-200 rounded-xl px-3 py-2 text-sm text-slate-700 placeholder-slate-400 focus:border-blue-400 focus:ring-2 focus:ring-blue-100 outline-none bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500 mb-1 block",children:"性别 *"}),e.jsxs("select",{value:r.gender,onChange:s=>d("gender",s.target.value),className:"w-full border border-slate-200 rounded-xl px-3 py-2 text-sm text-slate-700 focus:border-blue-400 focus:ring-2 focus:ring-blue-100 outline-none bg-white",children:[e.jsx("option",{value:"男",children:"男"}),e.jsx("option",{value:"女",children:"女"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500 mb-1 block",children:"床号 *"}),e.jsx("input",{type:"text",value:r.bedNo,onChange:s=>d("bedNo",s.target.value),placeholder:"如：301-1",className:"w-full border border-slate-200 rounded-xl px-3 py-2 text-sm text-slate-700 placeholder-slate-400 focus:border-blue-400 focus:ring-2 focus:ring-blue-100 outline-none bg-white"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"text-xs text-slate-500 mb-1 block",children:"所属科室 *"}),e.jsx("input",{type:"text",value:r.department,onChange:s=>d("department",s.target.value),placeholder:"输入科室名称，如：呼吸内科",list:"department-list",className:"w-full border border-slate-200 rounded-xl px-3 py-2 text-sm text-slate-700 placeholder-slate-400 focus:border-blue-400 focus:ring-2 focus:ring-blue-100 outline-none bg-white"}),e.jsx("datalist",{id:"department-list",children:G.map(s=>e.jsxs("option",{value:s.name,children:[s.icon," ",s.name]},s.id))}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"可选择已有科室或输入新科室名称"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"text-xs text-slate-500 mb-1 block",children:"诊断信息 *"}),e.jsx("textarea",{value:r.diagnosis,onChange:s=>d("diagnosis",s.target.value),placeholder:"请输入诊断信息",rows:2,className:"w-full border border-slate-200 rounded-xl px-3 py-2 text-sm text-slate-700 placeholder-slate-400 focus:border-blue-400 focus:ring-2 focus:ring-blue-100 outline-none resize-none bg-white"})]})]})]}),e.jsxs("div",{className:"bg-white/70 backdrop-blur-xl rounded-2xl p-4 border border-slate-100 shadow-sm mb-4",children:[e.jsxs("h5",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[e.jsx(W,{size:16,className:"text-amber-500"}),"当下存在的康复问题"]}),e.jsx("textarea",{value:r.rehabProblems||"",onChange:s=>c(x(i({},r),{rehabProblems:s.target.value})),placeholder:"描述患儿当前存在的康复问题，如：呼吸功能下降，运动耐力不足等",className:"w-full border border-slate-200 rounded-xl px-3 py-2 text-sm text-slate-700 placeholder-slate-400 focus:border-blue-400 focus:ring-2 focus:ring-blue-100 outline-none bg-white resize-none",rows:"3"})]}),e.jsxs("div",{className:"bg-white/70 backdrop-blur-xl rounded-2xl p-4 border border-slate-100 shadow-sm",children:[e.jsxs("h5",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[e.jsx(Y,{size:16,className:"text-rose-500"}),"安全提醒"]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:r.safetyAlerts.map((s,o)=>e.jsxs("span",{className:"bg-rose-100 text-rose-600 text-xs px-2.5 py-1 rounded-xl flex items-center gap-1 font-medium",children:[s,e.jsx("button",{onClick:()=>A(o),className:"hover:text-rose-700",children:e.jsx(Z,{size:12})})]},o))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:j,onChange:s=>f(s.target.value),placeholder:"添加安全提醒，如：防跌倒",className:"flex-1 border border-slate-200 rounded-xl px-3 py-2 text-sm text-slate-700 placeholder-slate-400 focus:border-blue-400 focus:ring-2 focus:ring-blue-100 outline-none bg-white",onKeyPress:s=>{s.key==="Enter"&&(p(j),f(""))}}),e.jsx("button",{onClick:()=>{p(j),f("")},className:"px-3 py-2 bg-rose-100 text-rose-600 rounded-xl text-sm font-semibold hover:bg-rose-200",children:"添加"})]}),e.jsx("div",{className:"flex flex-wrap gap-1.5 mt-2",children:["防跌倒","过敏体质","癫痫风险","禁止负重","监测血氧"].map(s=>e.jsxs("button",{onClick:()=>p(s),className:"text-xs px-2 py-0.5 bg-slate-100 text-slate-600 rounded-lg hover:bg-slate-200",children:["+ ",s]},s))})]}),e.jsxs("div",{className:"bg-white/70 backdrop-blur-xl rounded-2xl p-4 border border-slate-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h5",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[e.jsx(_,{size:16,className:"text-emerald-500"}),"治疗计划（可选）"]}),e.jsx("button",{onClick:M,className:"text-xs text-blue-500 hover:text-blue-600 font-semibold",children:"+ 添加项目"})]}),e.jsx("div",{className:"mb-3",children:e.jsx("input",{type:"text",value:r.treatmentPlan.focus,onChange:s=>c(o=>x(i({},o),{treatmentPlan:x(i({},o.treatmentPlan),{focus:s.target.value})})),placeholder:"治疗重点，如：改善呼吸功能，增强运动耐力（总时长20分钟）",className:"w-full border border-slate-200 rounded-xl px-3 py-2 text-sm text-slate-700 placeholder-slate-400 focus:border-blue-400 outline-none bg-white"})}),e.jsx("div",{className:"space-y-2",children:r.treatmentPlan.items.map((s,o)=>e.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 rounded-xl p-2",children:[e.jsx("input",{type:"text",value:s.name,onChange:N=>y(o,"name",N.target.value),placeholder:"项目名称",className:"flex-1 border border-slate-200 rounded-lg px-2 py-1 text-sm text-slate-700 placeholder-slate-400 bg-white"}),e.jsx("input",{type:"text",value:s.duration,onChange:N=>y(o,"duration",N.target.value),placeholder:"时长",className:"w-20 border border-slate-200 rounded-lg px-2 py-1 text-sm text-slate-700 placeholder-slate-400 bg-white"}),e.jsx("button",{onClick:()=>L(o),className:"p-1 text-slate-400 hover:text-rose-500",children:e.jsx(ee,{size:14})})]},o))})]}),e.jsxs("div",{className:"flex gap-3 pt-2 pb-4",children:[e.jsx("button",{onClick:()=>{m(0),c(null),b(null),h(""),v(0)},className:"flex-1 border border-slate-300 text-slate-600 py-3 rounded-xl font-semibold hover:bg-slate-50 transition",children:"取消"}),e.jsxs(z,{onClick:U,disabled:w,variant:"cyan",className:"flex-1 py-3 rounded-xl disabled:opacity-60",children:[e.jsx(P,{size:18}),"生成方案"]}),e.jsx(z,{onClick:E,disabled:g||w,variant:"emerald",className:`flex-1 py-3 rounded-xl ${g?"opacity-50 cursor-not-allowed":""}`,children:g?e.jsxs(e.Fragment,{children:[e.jsx(q,{size:18,className:"animate-spin"}),"建档中..."]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{size:18}),"确认建档"]})})]})]})]})};R.propTypes={isOpen:l.bool.isRequired,onClose:l.func.isRequired,aiStep:l.number.isRequired,setAiStep:l.func.isRequired,aiResult:l.object,setAiResult:l.func.isRequired,uploadedImage:l.string,setUploadedImage:l.func.isRequired,ocrText:l.string.isRequired,setOcrText:l.func.isRequired,ocrProgress:l.number.isRequired,setOcrProgress:l.func.isRequired,handleImageUpload:l.func.isRequired,updateFormField:l.func.isRequired,addSafetyAlert:l.func.isRequired,removeSafetyAlert:l.func.isRequired,addTreatmentItem:l.func.isRequired,updateTreatmentItem:l.func.isRequired,removeTreatmentItem:l.func.isRequired,handleGeneratePlan:l.func.isRequired,confirmAdmission:l.func.isRequired,isOcrProcessing:l.bool.isRequired,isSavingPatient:l.bool.isRequired,departments:l.arrayOf(l.shape({id:l.oneOfType([l.string,l.number]),name:l.string,icon:l.string})).isRequired};R.defaultProps={aiResult:null,uploadedImage:null};export{R as default};
